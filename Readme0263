----------------------------------------
//0277 [2007/08/18] by Rayce

・charサーバがmapサーバから担当マップ名を受信する際（0x2afa）、1024MAP以上でバッファオーバーフローが
　発生するときはcharサーバではなくmapサーバを落とすように変更（char.c）
・0x2afcでの認証に失敗したときの警告文を少し変更（char.c）
・auth_fifoのメンバ tick をunsigned int型に修正（login.c, char.c）
・login.cおよびchar.cの細かい整形（login.c, char.c）

・skill_additional_effect() の整形（skill.c）
・battle_damage() および battle_delay_damage() に引数を2つ追加（battle.*, skill.c, unit.c）
　スキルIDとスキルLvを参照できるようになります
・以下のスキルはディボーションでダメージを肩代わりできないように修正（battle.c）
	プレッシャー
	コーマ
	NPCダークブレッシング
	グランドクロスの反動

----------------------------------------
//0276 [2007/08/17] by Rayce

・0019以降、Mobに先制攻撃されると経験値が全く入らなくなってしまうバグを修正（mob.c）
・0225以降、キャラを新規作成するとキャラ名の末尾にゴミ文字が付加するバグを多分修正（char.c）
	reported by Cocoaさん and ぽぽりさん

----------------------------------------
//0275 [2007/08/17] by Rayce

・ディボーションの修正（battle.c, skill.c, status.c, unit.c）
	-> 献身対象者から来るダメージによって術者の詠唱が妨害されるように修正
	-> 献身対象者がダメージを受けても献身対象者の凍結/石化/睡眠が解除されないように修正
	-> 献身対象者がダメージを食らった場合、術者に被弾共闘が入るように修正
	-> 献身対象者がダメージを食らったとき術者が位置ズレを起こすので、ダメージディレイ
	   （ヒットストップ）を入れるように修正してみる
	-> 術者がインデュア、オートガード、リフレクトシールド、ディフェンダーを使ったら
	   献身対象者にも同じ効果がかかるように修正
	   ただし被ディボーション者にかかるディフェンダーは強制的にLv1
	-> 術者がインデュア、オートガード、リフレクトシールド、ディフェンダーを解除したら
	   献身対象者も解除されるように修正
	-> ディボーションが終了したとき、献身対象者にかかっているインデュア、オートガード、
	   リフレクトシールド、ディフェンダーを全て解除するように修正
	-> 献身対象者にかかったリフレクトシールドはプレイヤーから攻撃されたときのみ効果が
	   発動するように修正
	-> 定員がいっぱいのときは詠唱できずにスキル使用失敗となるように修正
	-> 違うクルセから既にディボーションされている人にはスキルが使用できないように修正
	-> Mobに対してスキルを使用したとき詠唱反応Mobのタゲ取りができるように修正
	-> ディボーション解除時の処理方法を少し変更
	   skill_devotion_end() は skill_devotion() に取り込んだので削除
	-> skill_devotion3() で既に糸が切れているときはパケット送信しないように改善
	-> stauts_change_start() で不要なステータス再計算をしないように修正

　※インデュア、オートガード、リフレクトシールド、ディフェンダーに関連する部分は本鯖の挙動が
　　イマイチわからないのでeAのコードを参考にしています。

・オートガードのガード確率計算式を一般式化（status.c）
・紛らわしい変数名を変更（clif.c, skill.*）

----------------------------------------
//0274 [2007/08/16] by Rayce

・ステータス異常 SC_ITEM_DELAY と SC_ACTION_DELAY の撤廃（clif.c, map.h, pc.c, status.*）
	プレイヤーにしか必要がない上に、不正検出のための重要なシステムでありながらスクリプトの
	sc_start命令等で操作される可能性があるという極めて良くない実装でした。
	代わりにmap_session_data構造体にメンバ item_delay_tick, drop_delay_tick, drop_delay_count
	を用意してこれまでと同様の不正検出を行うことにします。

・map_session_data構造体のメンバemotion_lasttickをemotion_delay_tickに改名（clif.c, map.h, pc.c）
・map_session_data構造体のメンバinfinit_tigereyeをspecial_stateに変更（map.h, pc.c, status.c）

・dropitem命令を使ったスクリプトの引数指定方法が間違っていたので修正（npc_quest_kiel.txt）
	reported by Cocoaさん

----------------------------------------
//0273 [2007/08/15] by Rayce

・倉庫関連の関数を見直し（mmo.h, guild.c, intif.c, storage.*, unit.c）
	-> intif_parse_LoadStorage() の内容を storage_storageload() として分離
	-> intif_parse_LoadGuildStorage() の内容を storage_guild_storageload() として分離
	-> storage_storage_quit() および storage_guild_storage_quit() はそれぞれ
	   storage_storageclose() および storage_guild_storageclose() にまとめる
	-> ギルド解散時にギルドメンバーが倉庫を開いていた場合の処理を少し書き換え
	-> storage構造体およびguild_storage構造体にdirtyメンバを追加
	   倉庫内アイテムのデータが変更されたときのみセーブを行うように改善
	-> 細かい整形

・pc_takeitem_sub() でPT未所属でもPT共有設定とみなされていた問題を修正（pc.c）
・account_db_final() におけるキャストミスを修正（login.c）
	thanks to FPE in AthenaProject Forum

----------------------------------------
//0272 [2007/08/14] by Rayce

・死んだ状態から@loadや@goなどで pc_setpos() を実行すると、デスペナが無くなったり
　移動先ですぐに死んでしまう等の問題を修正（clif.c, pc.c）
・VC++で警告レベルを /W4 にした際に得られた結果の中で気になった箇所を修正
　（db.c, malloc.c, socket.c, char.c, int_guild.c, clif.c, map.h, pc.c, status.c, login-converter.c）

・converterの起動時にもコマンドライン引数をサポートする（converter.*）
　　以下のコマンドを使ってconfファイルへのパスを変更することができます。

　　converter
	--converter-config <filename>

----------------------------------------
//0271 [2007/08/13] by Rayce

・AthenaProject2314よりmerge、thanks to Paraさん
	-> clif_sitting() を少し変更して「立つ」処理もまとめる（clif.*, skill.c）
	-> スクリプトにgetcartlist命令を追加（script.c）

・カート内アイテム削除命令を一式追加（script.c）
　これらはプレイヤーがカートを持っていなくてもアイテムの削除を行います
　カートがあるときだけ削除したい場合はcheckcart関数でカートの有無をチェックする必要があります
	delcartitem命令
	delcartitem2命令
	clearcartitem命令

・delinventory命令をdelitem2命令に改名（script.c）
	カート用の命令と一律の名前にするため
	delinventory命令をスクリプトで利用している場合は各自delitem2命令に変更してください

----------------------------------------
//0270 [2007/08/13] by Rayce

・db/item_avail.txtを使ったアイテムをshop販売するとアイテム数超過扱いにされて
　アイテムが買えない問題を修正（npc.c）
	ただし販売品目の中でavail元のアイテムIDが重複している場合にアイテムを正しく
	買うことができませんが、これはクライアントの仕様に依ります。
	例えばdb/item_avail.txtに 600,512 を記述して600のIDを作ったとき
		prontera.gat,116,192,4	shop	shopper	112,512:10,600:10
	となっている場合は600のアイテムを買うことができません（恐らく512になる）
	この事例が発生し得るときはdb/item_avail.txtを使わないことをお勧めします。

・ELE_MAXを10より小さい値に設定している場合、モンスター情報を使うと「unknown attr type」
　のエラー文が出るバグを修正（clif.c）
・鉱石の製造確率でDEX依存部分の計算式が間違っていたのを修正（skill.c）
	reported by Cocoaさん

----------------------------------------
//0269 [2007/08/12] by Rayce

・スキル使用チェック時のアイテム消費処理を skill_item_consume() としてまとめる（skill.c）
	-> inf2で処理分岐せず、植物栽培も一つにまとめる
	-> アイテム消費なしにする場合はgotoを使わずitem_nocostフラグをオンにする
	-> 副作用としてホムがジェムの必要なスキルを使うとき、主人がミストレスカードを
	   装備していればジェム消費なしになる

----------------------------------------
//0268 [2007/08/10] by Rayce

・nextやselectで待機中に run_script() が再帰的に実行されると元のスクリプトが
　破棄されてスクリプトがそれ以降停止してしまうバグを修正（script.c）
・別MAPに移動すると地面に設置したスキルユニットが消滅するように修正（pc.c）
	reported by Cocoaさん

----------------------------------------
//0267 [2007/08/09] by Rayce

・クレイモアトラップが攻撃されても移動しないように修正（battle.c, skill.c）
・PTメンバーのHPが0x7fffを越えている場合、HPメーターが更新されない問題を修正（clif.c）
　MAXHPが0x7fffのときは0x7fffで規格化する
・party_send_xyhp_timer() を少し修正（party.c）
・gccでの警告修正（pc.c）

・以下のファイルの改行コードをCR/LFに変更
	script/npc/town/npc_town_hugel.txt
	src/common/zlib/
	src/map/status.c

----------------------------------------
//0266 [2007/08/01] by Rayce

・オートスペルでリムーブトラップが使えないバグを修正（battle.c, skill.c, unit.c）
	db/skill_db.txtのinfが32の罠の場合は、場所スキルとしてではなく対象指定スキルとして
	扱われなければなりません

・運命のタロットカード専用の状態異常 SC_THE_MAGICIAN, SC_STRENGTH, SC_THE_DEVIL, SC_THE_SUN の
　使い方が特殊だったので仕様変更（skill.c, status.*）
	-> 魔法師、力、悪魔、太陽の効果がそれぞれ重複するようにしてみる
	-> 不要になった SC_TAROTCARD を削除

・ディテクティング用の状態異常 SC_DETECTING の使い方が特殊だったので仕様変更（skill.c, status.*）
	-> サイトと同じ処理方法で周囲のPCおよびMOBを炙り出す
	-> ディテクティングでNPCインビジブルが見破れなくなるが当面の間仕様にしておく
	-> 不要になった SC_DETECTING を削除

----------------------------------------
//0265 [2007/08/01] by Rayce

・スキルのstatictimerをギルドスキルも一括して扱えるように変更（map.h）
・臨戦態勢、激励、治療、緊急召集のスキルディレイはstatictimerを使うように変更（clif.c, skill,c status.*）
　以下のステータス異常は不要になったので削除
	SC_BATTLEORDER_DELAY
	SC_REGENERATION_DELAY,
	SC_RESTORE_DELAY
	SC_EMERGENCYCALL_DELAY,
・スキルのstatictimerの初期化が二重に行われていた無駄を修正（pc.c）
	pc_setnewpc() ではなく pc_authok() だけで行えば良い

----------------------------------------
//0264 [2007/08/01] by Rayce

・オートスペル使用後にディレイが無かったのを修正（battle.*, skill.*）
	battle_auriga.confに skill_autospell_delay_enable と bonus_autospell_delay_enable を追加
	スキル由来かアイテムボーナス由来かで個別に設定できます
	デフォルトでは共にyesですが、noにすれば今まで通りディレイ無しになります

・skill_bonus_autospell() の引数tickがunsigned int型になっていなかったので修正（skill.*）

----------------------------------------
//0263 [2007/07/30] by Rayce

・サーバースナップショット（version.h）
・不要なファイルをフォルダごと削除
	./script/mosnter/etc
