----------------------------------------
//0177 [2007/05/10] by Rayce

・int_guild.cとguild.cを全体的に整形
・ギルド城データベース castle_db をツリーDBから配列に単純化（int_guild.c, guild.c）
・エンブレム変更処理部分をclif.cからguild.cに移動（clif.c, guild.*）

・0115以降、以下のスクリプト命令/関数において、assignされてないMAP名を入れたときに処理が
　実行されなくなっていたバグを修正（script.c）
	getcastlename
	getcastledata
	setcastledata

・guild構造体から使われてないメンバ castle_id を削除（mmo.h, int_guild.c, char-converter.c）
	セーブデータの形式が変更されているのでご注意を

・TXT: JOURNAL_IDENTIFIERをバージョン04に変更しておく（journal.c）
・SQL: main.sql修正、Auriga-0177_changetable.sql添付

----------------------------------------
//0176 [2007/05/09] by Rayce

・mob.cの全体的な整形
・以下の関数の処理を少し改善（mob.c）
	mob_can_reach()
	mobskill_anothertarget()
	mobskill_use()

・0175に引き続き一部の関数および引数にconstを付ける
・0150以降、ギルド城にカプラとガーディアンが設置できなくなっていた問題を修正
　（script/npc/gvg/npc_gvg_steward.txt）

----------------------------------------
//0175 [2007/05/08] by Rayce

・AthenaProject2296を参考に以下を実装、thanks to Sheepさん
	Mobスキルの使用条件に myhpgtmaxrate, friendhpgtmaxrate を追加（mob.c）

・Mobが反撃可能かどうかを判定を行う際、ダメージディレイが消える場合があったので修正（mob.c）
・Mobのスキル使用条件の一部でホムがターゲットとして認識されてなかったので修正（mob.c）
・mob_can_counterattack() の引数を増やしてターゲットを二重に検索しないように改善（mob.c）

・一部の関数および引数にconstを付ける
・skill_timerskill構造体をmap.hからskill.hへ移動
・status_pretimer構造体をmap.hからstatus.hへ移動
・skill.cとstatus.cを少し整理

----------------------------------------
//0174 [2007/04/29] by Rayce

・AthenaProject2295よりmerge、thanks to Blazeさん
　以下Readmeより転載
　　・スクリプトに指定場所にアイテムをドロップするdropitem命令を追加（script.c）
　　・スクリプトに経験値を取得するgetexp命令を追加（script.c）
　　・カードの出血耐性の効果が反映されなかったのを修正（status.c）
　　・ガトリングフィーバー状態の攻撃力・移動速度・Flee値を修正（status.c）
　　・空蝉の回避方向を相手の位置関係から見て後方になるように修正（battle.c）
　　・命令追加による各種スクリプトの修正
	（npc_job_00novice.txt）
	（npc_quest_arena.txt）
	（npc_town_airport.txt）
	（npc_town_ayothaya.txt）
	（npc_town_einbroch.txt）
	（npc_town_hugel.txt）
	（npc_town_lighthalzen.txt）
	（npc_town_louyang.txt）
　　・初心者修練場の職業適性審査修正
	（npc_job_00novice.txt）
　　・ニブルヘイムのロードオブデスを修正
	（npc_town_niflheim.txt）

　　※dropitemの仕様はAthenaProjectをベースに改変しているので注意

----------------------------------------
//0173 [2007/04/27] by Rayce

・PC型Mob/Petに関する処理方法の見直し（clif.c, mob.*, skill.c, status.c, unit.c）
	mob_db構造体のメンバ view_class には pc_calc_class_job() の計算結果を保存しておきます。
	transが不要になるので削除し、代わりに pcview_flag を追加しています。
	view_class の値を使ってPC型であるかどうかを判定することもできますが、煩雑になるので
	実行速度を重視してフラグをstaticに保存しておくようにしました。
	今後は mob_is_pcview() を使って判定してください。

・見かけ取得系の関数 mob_get_* はあまり意味がないので全てマクロに書き換え
・typo修正、buttom → bottom

----------------------------------------
//0172 [2007/04/27] by Rayce

・取得可能なスキルの最大Lvをdb/skill_db.txtではなく、db/skill_tree.txtおよびdb/homun_skill_tree.txtの
　MaxLv設定に従うように拡張
	各職業ごとにスキルの最大Lvを変更できるようになります。
	例えばMagicianはファイヤーウォールをLv5までしか覚えられないが、WizardはLv10まで取得可能など。
	ただしdb/skill_db.txtで設定したMaxLvを越えることはありません。

	-> pc_get_skilltree_max() 追加
	-> homun_get_skilltree_max() 追加
	-> do_init() で do_init_skill() を do_init_pc() よりも優先して実行するように変更
	-> skill_db.txtの読み込み時にMAX_SKILL_LEVELを越えてないかチェックするように強化

　　※ただし @allskill は例外です。
　　　プレイヤーがGMでbattle_auriga.confのgm_allskillが設定されている場合は、skill_tree.txtのMaxLvではなく
　　　skill_db.txtのMaxLvまでスキルを取得します。

・養子職のスキルツリーを独自に設定できるように拡張
	今までは養子のスキルツリーは通常職と同じものを使っており、db/skill_tree.txtのUpperを2にしても
	全く反映されていませんでした。
	battle_auriga.confに追加されたbaby_copy_skilltreeをnoにすると、養子職専用のスキルツリーを作る
	ことができるようになります。

　　※noにした場合はskill_tree.txtに養子用のツリーを追加してください。
　　　デフォルトのままだと一切のスキルが取得ができない状態になります。

・db/skill_tree.txtおよびdb/homun_skill_tree.txtで、同一のスキルIDがある場合は下に書いたもので上書き
　されるように修正
・skill_use_bonus_autospell() の処理を少し最適化
・homun.cおよびhomun.hの整理
・db/skill_tree.txtのMaxLvの値が間違っていた部分を修正
・doc/db_refにスキルツリーに関する説明を追加

----------------------------------------
//0171 [2007/04/25] by Rayce

・試験的に、攻撃開始時に歩行停止を実行するとき座標補正パケットを送信しないようにしてみる（clif.c）
	shift押しで他PCをクリックしたとき、目的地に到着する直前で後方に引き戻されるのを解消するための処置です。
	並んでいるPCに対してshiftクリックすることでPCに重なることができるようになります。
	動きが幾分滑らかになってるはずですが、座標補正しないので見かけ上位置ズレする問題があります。
	これは結果的にAthena mod1468で行われた修正の一部を巻き戻すことになっています。

　　※shiftクリックで移動させる場合、まず clif_parse_Walktoxy() が呼ばれて移動開始します。
　　　クライアント側が目的地の半歩手前に到着した時に clif_parse_ActionRequest() のパケットが飛んできます。
　　　この時点ではまだサーバ側は目的地の１歩手前なので、座標補正すると引き戻されるようです。
　　　クライアントとサーバの擦り合わせがまだまだ不十分なのでこれで当面は保留。

・Mobのワープやスキルユニットの移動において、ブロックを変更する必要がない場合は
　map_delblock(), map_addblock() を実行しないように最適化（map.h, mob.c, skill.c）
	マクロ map_block_is_differ() 追加

・Mobの移動途中において、一歩先にバジリカのセルが設置されているかどうかの判定は
　恐らく不要なので削除してみる（unit.c）
・Auriga0170で添付し忘れた doc/client_packet.txt を同梱

----------------------------------------
//0170 [2007/04/25] by Rayce

・聖体降福に関する修正（skill.c）
	-> 発動条件がアコ系キャラが「周囲1セル内に2人居たら」になっていたので、「X軸方向の両隣に2人居たら」
	   に修正、片側に重なっていても可とする
	-> skill_check_condition_use_sub() でモンクがアコ系に含まれていなかったのを修正
	-> mapforeachinareaの実行は対象となる2人が確定した時点で検索打ち切りにする
	-> アコ系キャラが3人以上居た場合、全員がSPを消費してしまうのを修正
	-> 補助者のSP消費が遅延する問題を修正
	-> 補助者の消費SPは10固定ではなく、術者のSPの半分になるように拡張

・バード/ダンサーの合奏スキルに関する修正（skill.c）
	-> 自分と相方が共にPT未所属でも合奏が発動した問題を修正
	-> 相方が楽器もしくは鞭を装備してないと発動しないように修正
	-> 相方が死亡していたら発動しないように修正
	-> 相方のSPが発動に必要なSPに満たない場合は発動しないように修正
	-> 発動時に相方もSPを消費するように修正

・gmcommand命令で使うダミーsdのfdを-1にするように修正（script.c）

----------------------------------------
//0169 [2007/04/25] by Rayce

・temperタブへのキラー情報表示実装
	自分が最後に殺した相手の名前（Kill）と自分を最後に殺した相手の名前（Killed）を
	temperタブで見ることができます。

	-> charid2nick構造体をmmo.hからmap.hへ移動
	-> map_session_data構造体にメンバ kill_charid, killed_charid を追加
	-> clif_update_temper() 追加

　　※battle_auriga.confの set_pckillerid を save_pckiller_type に改名しています。
　　　また値の使い方が変更されているので確認してください。
　　　デフォルトでは無効になっているので利用したい場合には設定してください。
　　　PvP, GvG, PKで仕分けが可能になっています。

　　※PC_KILLER_IDは廃止されます。
　　　代わりに PC_KILL_CHAR, PC_KILLED_CHAR が用意されます。
　　　今まではアカウントIDでしたが、本実装に伴いキャラクターIDに変更されています。
　　　スクリプトから呼び出す場合には十分注意してください（script/sample/npc_test_pcevent.txt参照）。

　　※PC_KILL_CHAR, PC_KILLED_CHAR は埋め込み変数として登録されています（db/const.txt参照）。
　　　スクリプトや@writevarsから値を書き換えると即座に対象キャラのtemperタブへ反映されます。

・map_reqchariddb() で返信付きキャラ名問い合わせを複数のプレイヤーが同時に行うと、最初の人にしか
　返信されない問題を修正
	charid2nick構造体のメンバ req_id を linkdb_node型の req に変更しています。
	既に名前問い合わせ要求済みでキャラサーバからの返信待ちの場合、返信すべきプレイヤーのアカウントIDを
	リンクリストに保存しておきます。
	map_addchariddb() が呼び出されたときにリストにあるプレイヤー全員に返信します。
	このときtypeに応じて clif_solved_charname() および clif_update_temper() を実行します。

・接続完了時にパートナーの名前をキャラサーバに要求するように変更（clif.c, pc.c）
	「あなたに逢いたい」を使用したとき、パートナーが一度もログインしてなくても
	即座に名前が呼ばれるようになります。
	スキル使用時にキャラ名の問い合わせを行うと map_reqchariddb() や map_addchariddb() がややこしく
	なるからというのが理由。

----------------------------------------
//0168 [2007/04/24] by Rayce

・元職業の算出について最適化
	pc_base_job構造体の宣言をmap.hに移動し、map_session_data構造体のメンバとして追加
	pc_authok() および pc_jobchange() のときだけ pc_calc_base_job() を実行して
	元職業の情報を保存しておきます
	各関数でわざわざ pc_calc_base_job() を呼び出さず直接値を取得できます

----------------------------------------
//0167 [2007/04/24] by Rayce

・pc_calc_base_job() でtypeの判定を行うとき、スパノビならtype=3にするように変更（pc.c）
　今のところtypeは利用されてませんが一応残しておきます
・map_session_data構造体から使われていないメンバ mob_view_class を削除（map.h, pc.c）

・party_member_added() でサーバクラッシュする可能性を修正（party.c）
・Mobが寒いジョークおよびスクリームを使うとき姿が消えないように修正（skill.c）
・clif_displaymessage() と clif_disp_onlyself() を同調させる（clif.*）
　引数の仕様を変更してメッセージにconstを付けるように修正

----------------------------------------
//0166 [2007/04/23] by Rayce

・以下の敵指定型の範囲攻撃スキルで他PCをshift+クリックしても発動するように修正（skill.c）
　例え範囲内に敵が存在していなくてもSPもアイテムも矢も消費します
	グリムトゥース
	ブランディッシュスピア
	シャープシューティング
	スプレッドアタック
	風魔手裏剣投げ
	龍炎陣
	朔風

　これらのスキルは敵関係チェックを skill_castend_id() ではなく skill_castend_damage_id() で行います。
　必要に応じて is_enemy フラグを利用してください。
　また battle_skill_attack() に渡すフラグ値の使用ビットを拡張しています。
　0x01000000を渡したときはスキルエフェクトのみを表示し、ダメージ処理は行いません。

　※今のところは暫定でskill.cに直接ハードコーディングしてますが、いずれはskill_db.txtのinf2
　　あたりを使ってある程度の設定ができるようにしたいとは思ってます

・ベナムスプラッシャーをボス無効に修正
・ベナムスプラッシャーの処理方法を最適化
・風魔手裏剣投げのダメージが分散スプラッシュするように修正
・風魔手裏剣投げの範囲攻撃部分が多段HIT表示されるように修正
・龍炎陣のスキル倍率を修正してみる
	Lv5のとき 900% x 3hit → 300% x 3hit

----------------------------------------
//0165 [2007/04/22] by Rayce

・高速化のため map_charid2sd() を手抜きマクロから関数に変更（map.*）
・map_quit() を少し整理（map.c）
・map_freeblock_timer() を呼び出す間隔を1分から10分にしてみる（map.c）
	エラー自体見たことないのでこの処理を丸ごと削除しても良さそうだが･･･

・pc.c, pc.hの整理
・motdの表示処理を少しだけ改善（pc.c）
・skill_tree構造体のneedメンバの配列が一つ多かったので修正（pc.c）

----------------------------------------
//0164 [2007/04/21] by Rayce

・倉庫に関して
	-> storage_flagがあるときは移動できないようにanti hackerチェック強化（clif.c）
	-> ギルドを解散したときにギルド倉庫のロック解除をinterサーバに要求しないように修正（storage.c）
	-> 倉庫データ受信時に既に倉庫を開いていないかチェックするように強化（intif.c）
	-> 倉庫データを切断待ちのクライアントが受信するとデッドロック状態になる可能性を修正（intif.c）
	-> アイテムをソートするタイミングが間違っていたので修正（storage.c）
	-> 倉庫を開いたままログアウトするとアイテムがソートされないバグを修正（storage.c）
	-> 紛らわしいので関数名の変更（guild.c, intif.c, storage.*）
		guild_storage_delete  → storage_guild_delete
		guild_storage_additem → storage_guild_additem
		guild_storage_delitem → storage_guild_delitem

	-> 試験的に、倉庫を開いている時のみデータをセーブするようにする（pc.c, unit.c）
	   自動セーブの時に個人倉庫のデータを不必要にセーブしなくて済むようになります
	   代わりにギルド倉庫と同様に倉庫を閉じるときや離脱するときにセーブするように変更しています

	-> 倉庫を閉じた瞬間にサーバクラッシュされるとアイテムのデュープが起こる問題の対策
	   battle_auriga.confに save_player_when_storage_closed を追加
	   デフォルトではnoですが負荷が掛かることよりもデータの安全性を優先したい場合はyesにしてください

----------------------------------------
//0163 [2007/04/21] by Rayce

・AthenaProject2294を参考にして以下を修正、thanks to Blazeさん
	-> フェオリチャギを多段HIT表示されるように修正（skill.c）
	-> ピアーシングショットをDEF無視攻撃に修正（battle.c）

・ROメールの添付アイテムを取得する部分を mail_getappend() として切り離す（intif.c, mail.*）
・mail_calctimes() はほとんど意味がないので削除（mail.*）
・unit_movepos() の返り値が間違っていた部分を修正（unit.c）

----------------------------------------
//0162 [2007/04/20] by Rayce

・AthenaProject2293よりmerge、thanks to 名無しさん
	-> 生命保険証のデスペナ軽減回数を設定可能に拡張（pc.c）
	   例えば「sc_start SC_LIFEINSURANCE,1800000,3;」で3回デスペナを軽減します
	-> 武器精錬で精錬不可のものがリストに出てしまうのを修正（clif.c, skill.c）
	   AthenaProject BTS報告Cocoaさん thank's
	-> オシリスカード装備時にリザレクションをするとSP表示が反映されなかったのを修正（skill.c）
	   AthenaProject BTS報告masterさん thank's

----------------------------------------
//0161 [2007/04/20] by Rayce

・ダメージが負のときの属性補正計算が間違っていたので修正（battle.c）
・弓でも三段掌が発動するように修正（battle.c）
・三段掌の判定順をダブルアタックよりも優先するように修正（battle.c）
・ゴスペルはボス属性に対しては無効にしてみる（skill.c）
・ガンバンテインはミストレスカードやウィザードの魂があってもジェムを消費するように修正（skill.c）
・ゴスペル、グラフィティ、温もりのスキルユニットグループが削除されるとき
　状態異常も解除するように修正（skill.c）
・skill.cのプロトタイプ宣言について細かい修正（skill.*）
・SC_GOSPELにReleaseable+4が入っていたのを修正（db/scdata_db.txt）

----------------------------------------
//0160 [2007/04/20] by Rayce

・map_searchrandfreecell() の更なる最適化（map.*）
	呼び出し元で配列変数を用意して、関数内部で空きセルの座標を順に格納します
	あとは呼び出し元で atn_rand() を使って任意のセルを抽出してください
	MAPの範囲チェックは map_getcell() でも行われるのでここでは省略しています
	これに伴い cell_xy 構造体を新しく追加

・緊急召集の修正（skill.c）
	-> 範囲はギルドマスターの周囲7x7セル
	-> battle_auriga.confの emergencycall_point_randam を emergencycall_point_type に改名
	-> emergencycall_point_type が1の場合、出現位置は完全なランダム
	   2の場合も同様にランダムだが「崖越えEMC」を禁止する
	   デフォルトでは本鯖に近いと思われる1に設定

・運命のタロットカードに関する修正（skill.c, status.*）
	-> 出るカードの種類の出現確率に偏りを持たせる
	   統計を取っていたサイトのデータを参考に適当に設定しました
	-> 運命の輪が連続で出続けると理論上無限ループが起こる可能性を修正
	-> 魔術師、力、悪魔、太陽の効果時間はskill_cast_db.txtのupkeep_time2を利用する

・PC以外にも混乱が発揮するように修正（unit.c）
・script_read_vars() でメモリをアロケートしなくて済むように修正（script.c）
・battle_auriga.confの no_emergency_call をデフォルトでnoに変更しておく

----------------------------------------
//0159 [2007/04/19] by Rayce

・path_search_real() に渡す walkpath_data 構造体はNULLでも使えるように改善および処理の最適化（path.c）
	based on eA, thx a lot!!

・0125以降、一部の歩行経路で壁を回り込んでの移動ができなくなっていたバグを修正（unit.c）
・rand() を atn_rand() に変更し忘れ箇所を修正（char.c, httpd.c, journal.c, login.c, path.c）
・unit.cの細かい修正および整形

----------------------------------------
//0158 [2007/04/18] by Rayce

・friend.cを少し修正

・SQL: 見栄えが良くないので、拳聖の感情のセーブデータを memo テーブルから切り離して
       feel_info テーブルに保存するように変更（char.c, char-converter.c）

	memo テーブルで使っていた type フィールドは廃止
	付属のAuriga158-changetable.sqlを実行すると自動的にデータが feel_info テーブル
	にコンバートされます

----------------------------------------
//0157 [2007/04/18] by Rayce

・script.cのbuildinで使われている変数の一部をshort型からint型に変更（script.c, unit.*）
・スクリプトで使える基数として2進数をサポート（script.c）
	0bを頭に付けて記述します。
	ビットフラグを明瞭に表現したいときなどに。

	0b1101 [2進数] = 13 [10進数] = 0xd [16進数] = 015 [8進数]

----------------------------------------
//0156 [2007/04/17] by Rayce

・AthenaProject2292の一部をmerge、thanks to Blazeさん
	-> デスペラードのダメージ発生インターバルを150ms → 100msに変更（skill.c）
	-> 実行範囲を持つNPCの範囲内でhideon→offをした時、スクリプトが再走しなかったのを修正（npc.c）

・クローズコンファインをボス属性無効に修正（skill.c）
・ストーンカースのLv6が以上のとき成功時にジェムが消費されないバグを修正（skill.c）
・skill_check_condition2() を少しだけ書き換え（skill.c）
・usediteminfo関数で製造者のIDを取得するとき、名前入りアイテムでない場合は0が返るように修正（pc.c）

----------------------------------------
//0155 [2007/04/17] by Rayce

・anti hacker、merged from eA（clif.c, map.h）
	-> MAPロード時に認証完了しているかどうかチェックする
	-> エモーション使用時に1秒以上インターバルがあるかどうかチェックする
	   clif_parse_Emotion() のパケットを短時間に連続で送信されると周囲のプレイヤーを
	   サーバキャンセルで落とすことができる穴を防ぎます

----------------------------------------
//0154 [2007/04/17] by Rayce

・アイコンパケットを送信するだけの状態異常を廃止
	以下の5つの状態異常はsc_dataとして実装する必要がありません。
	状況に応じてアイコンパケット0x196を送り付けるだけで良いからです。

	SC_RIDING   : pc_isriding() で状態の取得が可能
	SC_FALCON   : pc_isfalcon() で状態の取得が可能
	SC_WEIGHT50 : pc_50overweight() で状態の取得が可能
	SC_WEIGHT90 : pc_90overweight() で状態の取得が可能
	SC_DEVIL    : SG_DEVILを覚えているかどうかで判断可能

	-> 重量オーバーのアイコンを送信したかどうかの判定のためmap_session_data構造体にicon_weightメンバ追加
	-> pc_checkweighticon() 変更
	-> pc_setoption() 変更

・1プレイヤーにのみアイコンパケットを送りつける clif_status_load() 追加（clif.*）
	merged from eA, thx a lot!!
・カートを外すときにクライアント側で保存されているアイテムデータを消去するように修正（clif.*, pc.c）
	clif_cart_clear() 追加
・チェンジカートを使用したときサーバ側でベースレベルのチェックをするように強化（pc.c）
・clif_status_change() に SI_*** ではなく SC_*** を渡していた箇所を修正（skill.c, status.c）
・タイガーアイのパケット送信に clif_status_load() を使うように改善（pc.c, status.c）

----------------------------------------
//0153 [2007/04/16] by Rayce

・BCCのときも__int64型をatn_bignumber型として使うように変更（utils.h）
	32bitに強制変換されるバグが発生するのは恐らくunsignedのときだけだと思います
	atn_bignumber型はsignedなので問題はないはず
	不具合が起こる人は BIGNUMBER_DOUBLE をdefineしてコンパイルしてください

・eAを参考に clif_parse_LoadEndAck() の書き換え（clif.c）
	一部の処理の順番を変更しました
	またテレポやMAP移動などによる画面の切り替え時にクライアントに送られるパケットの量が削減されます

----------------------------------------
//0152 [2007/04/15] by Rayce

・温もり系の吹き飛び方向およびセル数がおかしくなっていた問題を修正（battle.c）
・skill_blown() の処理順を少し修正（skill.c）
・0136のゴスペルの修正が不完全だったので再度修正（status.c）
・skill.c, status.cの細かい整形

----------------------------------------
//0151 [2007/04/15] by Rayce

・battle_auriga.confの party_join_limit がnoのときに、パーティの機能が誤作動するバグを修正（party.c）
	refered from AthenaProject2291, thanks

----------------------------------------
//0150 [2007/04/15] by Rayce

・AthenaProject2291の一部をmerge、thanks to 暇人さん
　以下Readmeより転載
　　・料理(課金用)、戦闘教範50、生命保険証の効果を実装 (pc.c、status.c、status.h)
　　・上記の効果実装の為、関連dbを更新 (const.txt、item_db.txt、scdata_db.txt)

・Expペナルティ処理を修正してまとめた pc_exp_penalty() を追加（pc.c）
・レディムプティオ使用時、mapflagにnopenaltyが設定されていてもExpペナルティを受けるように修正（pc.c）

・064以降、「レディムプティオ」と「パパ、ママ、大好き」によるデスペナルティ回避効果が
　発動しなくなっていたのを修正（db/scdata_db.txt）
・battle_auriga.confの death_penalty_type を2に変更しておく
・db/const.txtからギルドスキル系の定数を削除
・db/const.txtのオートスペル系の定義を16進数に変更

----------------------------------------
//0149 [2007/04/14] by Rayce

・AthenaProject2290の一部をmerge、thanks to Blazeさん
　以下Readmeより転載
　　・NPCスキル「不死属性付与」効果時の挙動を修正（status.c、status.h)
　　・拳聖スキル「太陽と月と星の奇跡」を暫定実装（battle.c、battle.h)
　　・太陽と月と星の奇跡の発動確率を変更できるように修正（battle_athena.conf）

・SI_NIGHT が SI_MIRACLE に変更されたので@night, @dayのエフェクト表示部分をコメントアウト（atcommand.c）

----------------------------------------
//0148 [2007/04/14] by Rayce

・AthenaProject2289-fixよりmerge、thanks to 暇人さん
　以下Readmeより転載
　　・料理使用時のアイコン(STR〜LUK、HIT、FLEE、CRITICAL)を表示するように修正 (status.c、status.h)
　　　AthenaProject BTS報告chaさん thank's
　　・料理使用時ログアウトしても効果が残るように修正 (scdata_db.txt)

----------------------------------------
//0147 [2007/04/14] by Rayce

・AthenaProject2288よりmerge、thanks to Blazeさん
　以下Readmeより転載
　　・NPCスキルの召喚系の仕様変更。種類 x Lv 匹 -> Lv 匹、召喚範囲の修正（mob.c)
　　・ソウルリンカースキル「エスク、エスウ、エスカ」の状態時、姿を維持しなかったのを修正（status.c)
　　・拳聖スキル「太陽と月と星の融合」状態のときは、移動速度が上がるように修正（status.c)
　　・拳聖スキル「太陽・月・星の温もり」のノックバック方向をMobの向きに依存するように修正（skill.c)
　　・MobスキルDBの召喚を変更に伴い修正（mob_skill_db.txt）

・skill_blown() で吹き飛ばしセル数が0のときは何も処理しないように修正（skill.c）
・mob_summonslave() の引数を一つ増やす（mob.*）

----------------------------------------
//0146 [2007/04/13] by Rayce

・高速化のため skill_get_skilldb_id() をマクロに変更（skill.h）
・db/skill_db.txtの読み込みの際、skill_get_skilldb_id() を使って
　スキルIDの範囲チェックを行うように最適化（skill.c）
・unit_skilluse_id() および unit_skilluse_pos() を最適化（unit.c）
・補正済み射程を返す skill_get_fixed_range() を追加（clif.c, mob.c, skill.*, unit.c）

・ギルドスキル使用時のNULLチェック追加（skill.c）
・skill_check_condition2() からギルドスキルに関するチェックを削除（skill.c）
	チェックが二重になるので skill_check_condition2_pc() だけで良い

----------------------------------------
//0145 [2007/04/13] by Rayce

・clif.cの全面的な修正や整形
	-> バッファオーバーフローする可能性を修正
		clif_GlobalMessage()
		clif_party_message()
	-> 引数の仕様を変更
		clif_clearflooritem()
		clif_dispchat()
		clif_clearchat()
		clif_showvendingboard()
		clif_closevendingboard()
	-> ホムの情報を参照すべきところがPCの情報を参照しているバグを修正
		clif_homskillinfoblock()
		clif_homskillup() 
	-> clif_set009e() を clif_dropflooritem() に吸収
	-> clif_set01e1() の処理を変更
	-> パケット送信用のバッファをunsigned char型に修正
	-> nullpoチェックが抜けてる箇所を修正

----------------------------------------
//0144 [2007/04/13] by Rayce

・0143の温もりに関する修正（battle.c, pc.c, skill.c, status.c, unit.c）
	-> status_change_end() 内でスキルユニットを削除する
	-> skill_unit_group のアドレスの保存先をsc_dataのval3からval4に変更
	-> battle_calc_weapon_attack() の一部を修正

----------------------------------------
//0143 [2007/04/12] by Rayce

・AthenaProject2286-fixよりmerge、thanks to Blazeさん
　以下Readmeより転載
　　・拳聖スキル「太陽・月・星の温もり」実装（skill.c、battle.c、status.c、unit.c、pc.c)
　　・マップを移動した時、拳聖スキル「太陽・月・星の安楽」の効果を削除するように修正（pc.c)
　　・スキルユニットを設置後、ハエやマップ移動で消えてしまうのを修正（pc.c、unit.c)
　　・上記変更に伴うunit_remove_map関数の仕様変更
　　	（unit.c、unit.h、pc.c、mob.c、npc.c、pet.c、script.c、atcommand.c)
　　・テコン系列の各種スキルの使用SPや詠唱時間などが間違っていたのを修正
　　	（skill_require_db.txt、skill_cast_db.txt）
　　・テコン系列の蹴りスキルを3段HITするように修正（skill_db.txt）
　　・ガンスリンガースキル「グラウンドドリフト」の発動時エフェクトを修正（skill.c、skill_unit_db.txt）
　　・モンスターの最低沸き間隔時間を5秒から1秒（本鯖仕様）に修正（mob.c、unit.c）

----------------------------------------
//0142 [2007/04/11] by Rayce

・guild_member構造体から使われないメンバ rsv1, rsv2 を削除
・guild_explusion構造体から使われてないメンバ acc, rsv1, rsv2, rsv3 を削除
	セーブデータの形式が変更されているのでご注意を

・mapif_parse_GuildLeave() を少し修正（int_guild.c）
・一部のmemcpyをstrncpyに修正（chat.c, clif.c, npc.c）

・TXT: JOURNAL_IDENTIFIERをバージョン03に変更しておく（journal.c）
・SQL: main.sql修正、Auriga-0142_changetable.sql添付

----------------------------------------
//0141 [2007/04/10] by Rayce

・家族PTによるLv差を無視した経験値公平機能実装（int_party.c, intif.*, party.c）
　以下の条件が揃ったときに設定可能
	-> 親子の3人だけのPT
	-> 養子キャラがオンライン
	-> 両親のうちどちらかがオンラインで養子キャラと同一MAPに居る
	   （もう一人の親については特に制限しない）
	-> 両親のLvが70以上
　以下は仕様
	-> 誰かがMAP移動やログアウトした時点で公平は解除
	-> 誰かが加入・脱退した時点で公平は解除

・party構造体のメンバ exp, item をunsigned char型に変更（mmo.h, inter.c, party.*）
・doc/inter_server_packet.txt修正

----------------------------------------
//0140 [2007/04/10] by Rayce

・TXT: アカウントデータ（auth_dat）およびキャラデータ（char_dat）の検索を高速化（login.c, char.c）
	バイナリサーチのアルゴリズムを使って検索します
	もしセーブデータのIDが順番に並んでない場合は、ロード時に挿入ソートして補正します

	login_id2idx() 追加
	char_id2idx() 追加

----------------------------------------
//0139 [2007/04/09] by Rayce

・プレイヤーの base_level, job_level を保存する変数をunsigned short型に変更（mmo.h, mob.*, pc.c）
	map.hのMAX_LEVELを増やせば255以上にも対応可能になります

・isspace() に渡す引数をunsigned char型にキャストするように修正（atcommand.c）
・clif_packet_debug() の関数本体を削除し忘れ（clif.c）
・細かい修正や整形（int_homun.*, int_party.c, int_pet.c, homun.c）

・SQL: levelに関連するフィールドの型を変更（main.sql, Auriga139_changetable.sql）

----------------------------------------
//0138 [2007/04/04] by Rayce

・AthenaProject2284よりmergeおよび一部改変、thanks to Blazeさん
　以下Readmeより転載
　　・Mobスキル「エモーション」によるモードチェンジ実装（skill.c)
	　　mob_skill_db.txt、エモーションの値2にmodeを入れるとその値へモードチェンジします。
	　　例）アルギオペ追跡時にノンアクティブ化（移動1+攻撃128=129）
	　　1099,エモーション＠アルギオペ,chase,197,1,100,0,5000,no,self,always,0,19,129,,,,
　　・Mobの複数の同じスキルは使用後ディレイを共有するように修正（mob.c)

・不要なローカルプロトタイプ宣言を削除（mob.c）
・mobskill_use_id() および mobskill_use_pos() を移動（mob.c）
・使われてないプロトタイプ宣言を削除（mob.h）
	mobskill_use_id2()
	mobskill_use_pos2()
	mobskill_use_id_sub_command_to_slave()

----------------------------------------
//0137 [2007/04/04] by Rayce

・AthenaProject2281よりmerge, thanks to 暇人さん
　以下Readmeより転載
　　・スキル「マグヌスエクソシズム」のFlag値をエラーが出ない様に修正 (db/skill_uniti_db.txt)
　　・飛行船NPCの一部修正 (npc_town_airport.txt)

・AthenaProject2282よりmerge, thanks to Paraさん
　以下Readmeより転載
　　・追加された2種類のペット「クリスマスゴブリン」「餅」を実装（db/pet_db.txt）

----------------------------------------
//0136 [2007/04/03] by Rayce

・AthenaProject2280よりmerge, thanks to Blazeさん
　以下Readmeより転載
　　・スキル「火炎陣」のHIT数を修正 (db/skill_db.txt)
　　・アサシン転職クエストのJob50時の処理を修正 (npc_job_12assassin.txt)
　　・混乱発動時の挙動を修正 (src/map/status.c)
　　・ゴスペル効果「全状態異常耐性」を耐性計算している状態異常のみに対して発動するように (status.c)
　　・ジークフリードの状態異常耐性実装 (status.c)

----------------------------------------
//0135 [2007/04/03] by Rayce

・AthenaProject2279よりmerge, thanks to Blazeさん
　以下Readmeより転載
　　・スキル「火炎陣」の仕様を修正 (skill.c)
　　・スキル「一閃」の仕様を修正 (skill.c)
　　・ファイアーボールが多段HITしていたのを修正 (skill.c)
　　・スキル「投擲修練」の効果が風魔手裏剣などに適用されていたのを修正 (battle.c)
　　・スキル「影分身」が影宝珠を消費せずに使用できたのを修正 (db/skill_require_db.txt)
　　・忍者スキル・ガンスリンガースキルの攻撃力・詠唱時間などを修正
　　　(src/map/battle.c、db/skill_db.txt、db/skill_cast_db.txt)
　　・ガンスリンガーのスキルで装備制限の相違を修正 (db/skill_db.txt)
　　・忍者スキル・ガンスリンガースキルで装備制限の相違を修正 (db/skill_db.txt)

----------------------------------------
//0134 [2007/04/03] by Rayce

・太陽と月と星の融合を使ったときに拳聖の魂が解除されるように修正（skill.c）
・死亡している敵プレイヤーがサイトブラスターの効果範囲内に居るとサイトブラスターが
　解除されてしまうバグを修正（status.c）
・不要な関数 clif_parse_debug() を削除（clif.c）

・db/packet_db.txtの一部を修正
・パケット解析結果を doc/client_packet.txt に反映

----------------------------------------
//0133 [2007/03/27] by Rayce

・clif_homskillup() は0x10eではなく0x239のパケットを使うように修正（clif.c）
・ホムの腹減り値に使うパケット0x230のtypeを0x200に修正（homun.c）

・party_share_loot() を party_loot_share() に改名（party.*, pc.c）
・party_member構造体のメンバのサイズ変更（mmo.h, int_party.c, party.*）
	leader : unsigned char
	online : unsigned char
	lv     : unsigned short

----------------------------------------
//0132 [2007/03/25] by Rayce

・battle_auriga.confを少し整形
・typo修正 penaly → penalty（battle.*, status.c）
・スクリプトのsc_end命令でダンス状態とバジリカが正常に解除されるように修正（script.c）

・ゴスペルに関する修正（skill.c, status.c, unit.c）
	-> ゴスペル中にハエの羽などでテレポートすると動けなくなる問題を修正してみる（unit.c）
	-> status_change_end() 内でスキルユニットを削除する
	-> skill_unit_group のアドレスの保存先をsc_dataのval3からval4に変更
	   グラフィティに合わせるため

----------------------------------------
//0131 [2007/03/24] by Rayce

・サーバースナップショット（version.h）
・不要なファイルを削除
	bcc32_consqlmake.bat
・全てにおいて「Athena」の冠を撤去、「Auriga」に変更
